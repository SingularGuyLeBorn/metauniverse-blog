# Elite Note: 鏋佸ぇ鏇存柊鍙傛暟鍖?(MuP / Maximal Update Parametrization)

## 1. 闂鐨勬彁鍑猴細鏍囧噯鍙傛暟鍖栫殑缂洪櫡
鍦ㄨ缁?Transformer 鏃讹紝鎴戜滑闇€瑕佹牴鎹ā鍨嬬殑澶у皬璋冩暣瓒呭弬鏁帮紝灏ゅ叾鏄?*瀛︿範鐜?(Learning Rate, LR)**銆?
*   **鏍囧噯瀹炶返 (Standard Practice / SP)**锛氬湪 PyTorch 鐨勯粯璁ゅ疄鐜颁腑锛岄殢鐫€妯″瀷瀹藉害 $W$ 鐨勫鍔狅紝濡傛灉淇濇寔 LR 涓嶅彉锛屾ā鍨嬬殑婵€娲诲€兼垨姊害浼氱垎鐐革紙鎴栨秷澶憋級銆?
*   **缁忛獙娉曞垯**锛氶€氬父闇€瑕佹墜鍔ㄥ皢 LR 缂╂斁涓?$O(1/W)$ 鎴?$O(1/\sqrt{W})$銆?
*   **鐥涚偣**锛氳繖鎰忓懗鐫€姣忓綋浣犳墿澶фā鍨嬭妯★紙渚嬪浠?7B 鍒?70B锛夛紝浣犻兘蹇呴』閲嶆柊鎼滅储鏈€浣?LR锛屾垨鑰呬緷璧栦笉閭ｄ箞绮剧‘鐨勭粡楠屾硶鍒欒繘琛屽鎺ㄣ€傝繖鍦ㄤ竾鍗¤缁冪殑瑙勬ā涓嬮闄╂瀬澶с€?

## 2. MuP 鐨勬牳蹇冩€濇兂
寰蒋鎻愬嚭鐨?**MuP (Maximal Update Parametrization)** 鏃ㄥ湪瑙ｅ喅杩欎釜闂銆傚叾鐩爣鏄細
**璁捐涓€绉嶅弬鏁板寲鏂瑰紡锛屼娇寰楁渶浣冲涔犵巼锛圤ptimal LR锛変笌妯″瀷瀹藉害 $W$ 鏃犲叧銆?*

濡傛灉瀹炵幇浜嗚繖涓€鐐癸紝浣犲氨鍙互锛?
1.  鍦ㄤ竴涓緢灏忕殑妯″瀷锛圥roxy Model锛屽瀹藉害 128锛変笂鎵弿鍑烘渶浣?LR銆?
2.  鐩存帴灏嗚繖涓?LR 搴旂敤浜庡搴︿负 16384 鐨勮秴澶фā鍨嬨€?
3.  淇濊瘉澶фā鍨嬬殑璁粌鍔ㄦ€侊紙Feature Learning锛夋槸鏈€澶у寲涓旂ǔ瀹氱殑銆?

## 3. 鎶€鏈疄鐜扮粏鑺?
MuP 閫氳繃閲嶆柊瀹氫箟鏉冮噸鐨勫垵濮嬪寲鏂瑰樊鍜屽墠鍚戜紶鎾腑鐨勭缉鏀惧洜瀛愭潵瀹炵幇杩欎竴鐐广€備笌鏍囧噯鍙傛暟鍖栵紙SP锛夌殑瀵规瘮濡備笅锛?

| 缁勪欢 | 鏍囧噯鍙傛暟鍖?(SP) | MuP | 鐩殑 |
| :--- | :--- | :--- | :--- |
| **鏉冮噸鍒濆鍖?* | $W \sim \mathcal{N}(0, 1/fan\_in)$ | $W \sim \mathcal{N}(0, 1/fan\_in)$ | 淇濇寔婵€娲诲€肩殑鏂瑰樊绋冲畾 |
| **Embedding 鍒濆鍖?* | $\mathcal{N}(0, 1)$ | $\mathcal{N}(0, 1)$ | 鍚屼笂 |
| **Output Logits 缂╂斁**| $1$ | $1/width$ |**鍏抽敭鐐?*锛氶槻姝?Logits 闅忓搴︾垎鐐?|
| **Adam 瀛︿範鐜?*| 闅忓搴﹁“鍑?|**甯告暟** (瀵逛簬闅愯棌灞傛潈閲? | 瀹炵幇 LR 杩佺Щ |
| **Attention 缂╂斁** | $1/\sqrt{d_{head}}$ | $1/d_{head}$ | 绋冲畾娉ㄦ剰鍔涙満鍒剁殑姊害 |

### 3.1 鏍稿績鏈哄埗锛氬紶閲忔洿鏂伴噺鐨勭ǔ瀹氭€?
鍦?SP 涓紝闅忕潃瀹藉害澧炲姞锛屾ā鍨嬪弬鏁版洿鏂伴噺锛?\Delta W$锛夌浉瀵逛簬鍙傛暟鏈韩锛?W$锛夌殑姣旂巼浼氬彂鐢熷彉鍖栵紝瀵艰嚧鈥滅壒寰佸涔犫€濅笌鈥滄噿鎯板涔狅紙Lazy Learning / NTK regime锛夆€濅箣闂寸殑杞崲銆?
MuP 纭繚浜嗗湪鏃犻檺瀹芥瀬闄愪笅锛屾瘡涓€灞傜殑**鏇存柊閲忕煩闃电殑璋辫寖鏁帮紙Spectral Norm锛?* 淇濇寔鍦?$O(1)$ 绾у埆銆傝繖淇濊瘉浜嗘ā鍨嬪湪浠讳綍瑙勬ā涓嬮兘澶勪簬鈥滅壒寰佸涔犫€濈殑鏈€浣崇姸鎬侊紝涓旇秴鍙傛暟鍏锋湁瀹岀編鐨勫彲杩佺Щ鎬с€?

## 4. 褰卞搷涓庣幇鐘?
*   **瀛︽湳鐣?*锛歁uP 鏄叧浜庢棤闄愬绁炵粡缃戠粶鐞嗚锛圛nfinite-width Neural Networks锛夌殑閲嶈鎴愭灉銆?
*   **宸ヤ笟鐣?*锛氳櫧鐒?PyTorch 榛樿浠嶄娇鐢?SP锛屼絾璁稿鍓嶆部澶фā鍨嬶紙濡?Cerebras 鐨勬ā鍨嬶紝浠ュ強鎹帹娴嬬殑 GPT-4 绾у埆妯″瀷锛夐兘鍦ㄤ娇鐢?MuP 鎴栧叾鍙樹綋锛堝 u-Transfer锛夋潵娑堥櫎瓒呭弬鏁版悳绱㈢殑鎴愭湰銆?
*   **鍙樹綋**锛氳搴т腑鎻愬埌 Meta 鍦?LLaMA 璁粌涓娇鐢ㄤ簡绫讳技鐨勬€濊矾锛岀敋鑷冲彲鑳藉瓨鍦?"Meta-P" 杩欐牱鐨勫唴閮ㄥ彉浣擄紝铏界劧缁嗚妭鏈叕寮€锛屼絾鏍稿績閫昏緫鏄竴鑷寸殑锛?*Scale-Invariant Hyperparameters**銆
